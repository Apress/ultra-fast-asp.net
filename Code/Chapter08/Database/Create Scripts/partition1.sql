CREATE PARTITION FUNCTION ByMonthPF (DATETIME)
	AS RANGE RIGHT FOR VALUES (
	'20090101', '20090201', '20090301',
	'20090401', '20090501', '20090601',
	'20090701', '20090801', '20090901')

CREATE PARTITION SCHEME ByMonthPS
	AS PARTITION ByMonthPF
	ALL TO ([PRIMARY])
	
SELECT $partition.ByMonthPF('20090215')

DROP TABLE [Traffic].[PageViews]

CREATE TABLE [Traffic].[PageViews] (
	[PvId]		BIGINT				IDENTITY,
	[PvDate]	DATETIME			NOT NULL,
	[UserId]	UNIQUEIDENTIFIER	NULL,
	[PvUrl]		VARCHAR(256)		NOT NULL
) ON ByMonthPS ([PvDate])